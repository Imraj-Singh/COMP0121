clc
clear

%% Problem 4.1 FID sequence signal visualisation
% Author: Imraj Singh 03/11/2020

% Given parameters

% Magnitisation aligned along z-axis initially
Mperp = zeros(3,101);

Mperp(1,:) = [5.30443588617120e-30;4.89661147488452e-30;4.52014209437027e-30;4.17261705530352e-30;3.85181101096235e-30;3.55566970741138e-30;3.28229682926323e-30;3.02994185678591e-30;2.79698885660015e-30;2.58194613418886e-30;2.38343668195952e-30;2.20018936169436e-30;2.03103076492604e-30;1.87487769911738e-30;1.73073025153102e-30;1.59766538637414e-30;1.47483103421809e-30;1.36144063584502e-30;1.25676810558356e-30;1.16014318188155e-30;1.07094713534386e-30;9.88608806751858e-31;9.12600949694427e-31;8.42436854390893e-31;7.77667231086772e-31;7.17877333065432e-31;6.62684300853144e-31;6.11734710611336e-31;5.64702311017422e-31;5.21285934142493e-31;4.81207566948363e-31;4.44210571054975e-31;4.10058039378590e-31;3.78531279117631e-31;3.49428411372127e-31;3.22563078429525e-31;2.97763250439089e-31;2.74870123833540e-31;2.53737104444060e-31;2.34228868797125e-31;2.16220497582276e-31;1.99596675742051e-31;1.84250954061921e-31;1.70085067531892e-31;1.57008306114964e-31;1.44936933893200e-31;1.33793652871972e-31;1.23507108008897e-31;1.14011430297953e-31;1.05245814982961e-31;9.71541321995544e-32;8.96845675524169e-32;8.27892903262525e-32;7.64241472059127e-32;7.05483795444365e-32;6.51243623685579e-32;6.01173634504225e-32;5.54953209027516e-32;5.12286378733019e-32;4.72899930239665e-32;4.36541655809334e-32;4.02978738356285e-32;3.71996260622950e-32;3.43395828975748e-32;3.16994303008503e-32;2.92622622818587e-32;2.70124726446369e-32;2.49356550545861e-32;2.30185107887470e-32;2.12487635785695e-32;1.96150809998825e-32;1.81070019066894e-32;1.67148694441190e-32;1.54297692115847e-32;1.42434721801871e-32;1.31483819988340e-32;1.21374863516595e-32;1.12043120552615e-32;1.03428836082288e-32;9.54768492753037e-33;8.81362402675258e-33;8.13600041000131e-33;7.51047497268060e-33;6.93304221640919e-33;6.40000460015595e-33;5.90794886335362e-33;5.45372416937807e-33;5.03442192943678e-33;4.64735717767043e-33;4.29005137820484e-33;3.96021655405940e-33;3.65574063628319e-33;3.37467393950289e-33;3.11521667728010e-33;2.87570743733352e-33;2.65461254282820e-33;2.45051623160770e-33;2.26211159048285e-33;2.08819218652539e-33;1.92764434177844e-33;1.77944000191538e-33];

Mperp(2,:) = [0.426990406279620;0.394161823786988;0.363857222659337;0.335882549987676;0.310058672359650;0.286220228794131;0.264214571866385;0.243900790243407;0.225148806370307;0.207838543529870;0.191859156941613;0.177108323976762;0.163491588944089;0.150921758251013;0.139318342066923;0.128607038913461;0.118719259881398;0.109591689427442;0.101165879938599;0.0933878774679085;0.0862078762449785;0.0795798997490158;0.0734615063021262;0.0678135172976775;0.0625997663234590;0.0577868675731686;0.0533440020632718;0.0492427202862886;0.0454567600368178;0.0419618782437613;0.0387356957319018;0.0357575539187776;0.0330083825292251;0.0304705774805107;0.0281278881561000;0.0259653133462310;0.0239690051889569;0.0221261804965522;0.0204250388994685;0.0188546872836823;0.0174050700375753;0.0160669046616900;0.0148316223290417;0.0136913130153714;0.0126386748479855;0.0116669673488410;0.0107699682724743;0.00994193376238646;0.00917756157075212;0.00847195710593109;0.00782060209037141;0.00721932562820734;0.00666427749728617;0.00615190349460148;0.00567892267725969;0.00524230635324418;0.00483925868744621;0.00446719879877514;0.00412374423370808;0.00380669571045356;0.00351402303603957;0.00324385210614732;0.00299445290444531;0.00276422842457840;0.00255170444387490;0.00235552008328834;0.00217441909312548;0.00200724180875933;0.00185291772481642;0.00171045864028757;0.00157895233066771;0.00145755670660464;0.00134549442165222;0.00124204789459919;0.00114655471449962;0.00105840339898126;0.000977029478670779;0.000901911882662608;0.000832569601886199;0.000768558609005764;0.000709469015129396;0.000654922445120773;0.000604569614706491;0.000558088093864232;0.000515180242169831;0.000475571302882397;0.000439007643563130;0.000405255131961803;0.000374097636771014;0.000345335643647933;0.000318784977641357;0.000294275623843235;0.000271650638712815;0.000250765145102170;0.000231485404547830;0.000213687960888025;0.000197258849721764;0.000182092868647585;0.000168092903609020;0.000155169307033080;0.000143239323779723];

Mperp(3,:) = [-0.557601566142810;-0.514731120477217;-0.475156711306427;-0.438624927302279;-0.404901840325383;-0.373771507486393;-0.345034588374264;-0.318507068597067;-0.294019081461642;-0.271413820246826;-0.250546534105089;-0.231283601162925;-0.213501672884663;-0.197086884220724;-0.181934124482561;-0.167946364275393;-0.155034034178820;-0.143114451196733;-0.132111289303857;-0.121954090698604;-0.112577814632600;-0.103922420927837;-0.0959324855145594;-0.0885568455279889;-0.0817482716913228;-0.0754631658871160;-0.0696612819804831;-0.0643054681064327;-0.0593614287710925;-0.0547975052434615;-0.0505844728314467;-0.0466953537440591;-0.0431052443414473;-0.0397911556665801;-0.0367318662374353;-0.0339077861570639;-0.0313008316713681;-0.0288943093713365;-0.0266728092982332;-0.0246221062672526;-0.0227290687777697;-0.0209815749269053;-0.0193684347879623;-0.0178793187566915;-0.0165046914065591;-0.0152357504294618;-0.0140643702709034;-0.0129830500987051;-0.0119848657720713;-0.0110634255034487;-0.0102128289292643;-0.00942762932745423;-0.00870279873984704;-0.00803369577606582;-0.00741603589278363;-0.00684586395801857;-0.00631952892478606;-0.00583366045193318;-0.00538514732244876;-0.00497111752105268;-0.00458891984349274;-0.00423610691978615;-0.00391041954269613;-0.00360977220109255;-0.00333223972556060;-0.00307604496074391;-0.00283954738548294;-0.00262123260787873;-0.00241970266801453;-0.00223366708623957;-0.00206193459969355;-0.00190340553415730;-0.00175706476238339;-0.00162197520381606;-0.00149727182407640;-0.00138215609578906;-0.00127589088528081;-0.00117779573240844;-0.00108724249329065;-0.00100365131804276;-0.000926486937757762;-0.000855255236957888;-0.000789500089568602;-0.000728800438154490;-0.000672767597714152;-0.000621042766769202;-0.000573294729809833;-0.000529217736384767;-0.000488529543254512;-0.000450969607071037;-0.000416297416010832;-0.000384290949678117;-0.000354745257416314;-0.000327471145924134;-0.000302293967772532;-0.000279052503064899;-0.000257597927079315;-0.000237792857282228;-0.000219510473611209;-0.000202633706393580;-0.000187054486700823];

time = linspace(0,8,101);


plot(time,sqrt(Mperp(1,:).^2),'k-','linewidth',2)
hold on
plot(time,sqrt(Mperp(2,:).^2),'k--','linewidth',2)
plot(time,sqrt(Mperp(3,:).^2),'k-.','linewidth',2)

grid on
box on
xlim([0 max(time)]);
ylim([0 0.6]);
xlabel("Time", "interpreter", "latex", "fontsize", 15)
ylabel("Signal", "interpreter", "latex", "fontsize", 15)#
legend(
hold off
